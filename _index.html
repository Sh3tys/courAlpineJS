<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Apprentissage Alpine.js</title>

    <!-- Import Alpine.js -->
    <script src="https://unpkg.com/alpinejs" defer></script>
  </head>

  <body style="font-family: sans-serif; line-height: 1.6;">
    <h1>üß† Atelier d'apprentissage Alpine.js</h1>
    <hr />

    <!-- x-text : afficher une variable -->
    <section x-data="{ message: 'Hello World!' }">
      <h2>1Ô∏è‚É£ x-text</h2>
      <h3 x-text="message"></h3>
    </section>

    <hr />

    <!-- Compteur basique -->
    <section x-data="{ count: 0 }">
      <h2>2Ô∏è‚É£ Compteur interactif</h2>
      <button @click="alert('Ceci est une alerte')">Alerte</button>
      <button @click="count++">+</button>
      <button @click="count--">-</button>
      <button @click="count = 0">Reset</button>

      <p>Valeur : <span x-text="count"></span></p>

      <!-- x-show : affichage conditionnel -->
      <p x-show="count === 5">üéâ Le compteur est √† 5 !</p>

      <!-- $watch : observer une variable -->
      <div x-init="$watch('count', value => console.log('Count modifi√© :', value))"></div>
    </section>

    <hr />

    <!-- x-show + transition -->
    <section x-data="{ open: false }">
      <h2>3Ô∏è‚É£ x-show et transitions</h2>
      <button @click="open = !open">Basculer</button>

      <div x-show="open" x-transition.opacity.duration.1000ms>
        <p>Ce contenu appara√Æt/dispara√Æt avec une transition douce</p>
      </div>
    </section>

    <hr />

    <!-- x-for -->
    <section x-data="{ fruits: ['Apple', 'Banana', 'Orange'] }">
      <h2>4Ô∏è‚É£ Boucle avec x-for</h2>
      <template x-for="fruit in fruits" :key="fruit">
        <div><span x-text="fruit"></span></div>
      </template>
    </section>

    <hr />

    <!-- x-model + computed property -->
    <section
      x-data="{ 
        search: '',
        fruits: ['foo', 'bar', 'baz', 'qux', 'quux', 'corge'],
        get filteredItems() {
          return this.fruits.filter(fruit => fruit.includes(this.search));
        }
      }"
    >
      <h2>5Ô∏è‚É£ Filtrage avec x-model et getter</h2>

      <input type="text" x-model="search" placeholder="Rechercher..." />

      <template x-for="fruit in filteredItems" :key="fruit">
        <div><span x-text="fruit"></span></div>
      </template>

      <!-- x-effect : r√©action √† des changements -->
      <div x-effect="console.log('Recherche actuelle :', search)"></div>
    </section>

    <hr />

    <!-- M√©thodes dans x-data -->
    <section
      x-data="{
        fruits: ['Apple', 'Banana', 'Orange'],
        choice(i) {
          if (i === '0') this.fruits.pop();
          else if (i === '1') this.fruits = [];
          else if (i === '2') this.fruits = ['Apple', 'Banana', 'Orange'];
        }
      }"
    >
      <h2>6Ô∏è‚É£ M√©thodes personnalis√©es</h2>
      <template x-for="fruit in fruits" :key="fruit">
        <div><span x-text="fruit"></span></div>
      </template>

      <button @click="choice('0')">Supprimer le dernier</button>
      <button @click="choice('1')">Vider</button>
      <button @click="choice('2')">Reset</button>
    </section>

    <hr />

    <!-- Alpine.store + data externe -->
    <section>
      <h2>7Ô∏è‚É£ Stores et composants partag√©s</h2>

      <div x-data="dropdown">
        <button @click="toggle">Basculer dropdown</button>
        <div x-show="open">Contenu visible</div>
      </div>

      <div x-data="dropdown">
        <button @click="toggle">Basculer dropdown</button>
        <div x-show="open">Contenu visible</div>
      </div>
    </section>

    <hr />

    <!-- Utilisation du store -->
    <section x-data>
      <h2>8Ô∏è‚É£ Store global (onglets)</h2>

      <template x-for="ong in $store.tabs.onglets" :key="ong">
        <button 
          @click="$store.tabs.current = ong"
          :class="{ 'font-bold': $store.tabs.current === ong }"
        >
          <span x-text="ong"></span>
        </button>
      </template>

      <p>Onglet actif : <strong x-text="$store.tabs.current"></strong></p>

      <div x-show="$store.tabs.current === 'Home'">üè† Accueil</div>
      <div x-show="$store.tabs.current === 'Profile'">üë§ Profil</div>
      <div x-show="$store.tabs.current === 'Account'">üí∞ Compte</div>
    </section>

    <hr />

    <!-- Transitions personnalis√©es -->
    <section x-data="{ visible: false }">
      <h2>9Ô∏è‚É£ Transitions personnalis√©es</h2>
      <button @click="visible = !visible">
        <span x-text="visible ? 'Cacher' : 'Afficher'"></span> contenu
      </button>

      <div
        x-show="visible"
        x-transition:enter="transition ease-out duration-500"
        x-transition:enter-start="opacity-0 scale-90"
        x-transition:leave="transition ease-in duration-300"
        x-transition:leave-end="opacity-0 scale-90"
        style="background: #eef; padding: 10px; margin-top: 10px"
      >
        <p>Contenu avec effet d‚Äôapparition/disparition</p>
      </div>
    </section>

    <hr />

    <!-- x-bind et styles dynamiques -->
    <section x-data="{ color: 'red', size: 20 }">
      <h2>üîü Liaison dynamique avec x-bind</h2>
      <input type="color" x-model="color" />
      <input type="range" min="10" max="50" x-model="size" />

      <p x-bind:style="`color: ${color}; font-size: ${size}px; font-weight: bold;`">
        Ce texte change dynamiquement !
      </p>
    </section>

    <hr />

    <!-- Gestion des √©v√©nements clavier et souris -->
    <section x-data="{ input:'', input2:'', input3:'', isActive: false }">
      <h2>1Ô∏è‚É£1Ô∏è‚É£ Gestion des √©v√©nements</h2>

      <h3>Clavier :</h3>
      <input type="text" @keyup.enter="alert('Entr√©e press√©e')" placeholder="Entr√©e" />
      <input type="text" @keyup.shift.enter="alert('Shift + Entr√©e')" placeholder="Shift+Entr√©e" />
      <input type="password" @keyup="console.log($event.key)" placeholder="Mot de passe" />

      <h3>Souris :</h3>
      <div
        @mouseenter="isActive = true"
        @mouseleave="isActive = false"
        :style="{
          width: '200px',
          height: '80px',
          'background-color': isActive ? 'black' : '#eee',
          color: isActive ? 'white' : 'black',
          'text-align': 'center',
          'line-height': '80px',
          'border-radius': '10px'
        }"
      >
        Passez la souris ici
      </div>
    </section>

    <hr />

    <!-- Formulaires et √©v√©nements personnalis√©s -->
    <section>
      <h2>1Ô∏è‚É£2Ô∏è‚É£ Formulaires et √©v√©nements</h2>

      <form @submit.prevent="alert('submit prevent')">
        <input type="text" placeholder="Nom" />
        <button type="submit">Envoyer</button>
      </form>

      <form @submit.stop="alert('submit stop')">
        <input type="text" placeholder="Nom" />
        <button type="submit">Envoyer</button>
      </form>

      <h3>$event :</h3>
      <button @click="$event.target.remove()">Supprimer ce bouton</button>

      <h3>Custom events :</h3>
      <div
        x-data
        @foo.window="alert('Event foo re√ßu !')"
        style="margin-top: 10px; padding: 5px; border: 1px solid #ccc"
      >
        Parent √©coutant l'event
      </div>
      <div x-data style="margin-top: 10px">
        <button @click="$dispatch('foo')">Envoyer un custom event</button>
      </div>
    </section>

    <script>
      // === Initialisation Alpine ===
      document.addEventListener("alpine:init", () => {
        // Composant dropdown r√©utilisable
        Alpine.data("dropdown", () => ({
          open: false,
          toggle() {
            this.open = !this.open;
          },
        }));

        // Store global pour les onglets
        Alpine.store("tabs", {
          onglets: ["Home", "Profile", "Account"],
          current: "Home",
        });
      });
    </script>
  </body>
</html>
